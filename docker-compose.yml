version: "3.9"

services:
  frontend:
    build:
      context: ./frontend    
      args:
        BACKEND1_URL: ${BACKEND1_URL}
        BACKEND2_URL: ${BACKEND2_URL}
    container_name: frontend
    ports:
      - "${FRONTEND_PORT}:80"
    env_file:
      - ./.env-docker      
    depends_on:
      - backend1
      - backend2
    networks:
      - internal      

  backend1:
    build:
      context: ./backend1   
    container_name: backend1
    env_file:
      - ./backend1/.env
    ports:
      - "${BACKEND1_PORT}:${BACKEND1_PORT}"
    networks:
      - internal

  backend2:
    build:
      context: ./backend2   
    container_name: backend2
    ## Enable this if you want to make your backend2 be acessible
    # environment:
    #   - PORT=4002
    # ports:
    #   - "4002:4002"
    networks:
      - internal       

networks:
  internal:
    driver: bridge